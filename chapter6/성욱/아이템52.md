# 테스팅 타입의 함정에 주의하기

dtslint 또는 타입 시스템 외부에서 타입을 검사하는 유사한 도구를 사용하는 것이 더 안전하고 간닪다

```typescript
declare function map<U, V>(array: U[], fn: (u: U) => V): V[];

map(['2017', '2018', '2019'], v => Number(v));

// 실행만 체크하고 반환 타입이 맞는지 체크하지 않음
test('square a number', () => {
	square(1);
	square(2);
})

const lengths: number[] = map(['john', 'paul'], name => name.length);

function assetType<T>(x: T) {}

assertType<number[]>(map(['john', 'paul'], name => name.length));

const beatles = ['john', 'paul', 'george', 'ringo'];
assertType<{name: string}[]>(
	map(beatles, name => ({
		name,
		inYellowSubmarine: name === 'ringo' // 이 속성은 체크하지 않음
	})); // 정상
)

const double = (x: number) => 2 * x;
assertType<(a: number, b: number) => number>(double); // 정상, 매개변수가 더 적은 함수 타입에 할당 가능 (Assignability)

// 제대로 된 assertType 사용 방법
const double = (x: number) => 2 * x;
let p: Parameters<typeof double> = null!;
assertType<[number, number]>(p); // '[number]' 형식의 인수는 '[number, number]' 형식의 매개변수에 할당될 수 없습니다.
let r: ReturnType<typeof double> = null!;
assertType<number>(r); // 정상

// dtslint 사용하여 테스트
const beatles = ['john', 'paul', 'george', 'ringo'];
map(beatles, function(
	name,	// $ExpectType string
	i,		// $ExpectType number
	array	// $ExpectType string[]
) {
	this	// $ExpectType string[]
	return name.length	// $ExpectType string[]
}); // $ExpectType number[]
```