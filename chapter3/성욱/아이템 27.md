# 함수형 기법과 라이브러리로 타입 흐름 유지하기

csv 데이터를 파싱한다고 해보자.

```
const csvData  = "...";
const rawRows = csvdata.split('\n');
const headers = raawRows[0].split(',');

// 1
const rows = rawRows.slice(1).map(rowStr => {
	const row = {};
	rowStr.split(',').forEach((val, j) => {
		row[headers[j]] = val;
	})
	return row;
})

// 2
const rows = rawRows.slice(1).map(rowStr => rowStr.split(',').reduce(
	(row, val, i) => (row[headers[i]] = val, row),
	{}));

// 3
import _ from 'lodash';
const rows = rawRows.slice(1).map(rowStr => _.zipObject(headers, rowStr.split(',')));
```

타입스크립트는 서드파티 라이브러리를 사용하는 것이 무조건 유리하다. 타입 정보를 참고하며 작업할 수 있기 때문에 서드 파티 라이브러리 기반으로 바꾸는데 시간이 훨씬 단축된다.

1, 2번은 타입 오류를 발생시켜 `{[column: string]: string}` 또는 `Record<string, string>`을 제공해야 해결되지만 3번은 별도 수정 없이도 타입 체커를 통과한다.

Array.prototype.flat을 사용해서 T[][] => T[] 형태로 다차원 배열을 평탄화(flatten)해줄 수 있다. (함수형 기법 사용의 예시)

loadash같은 서드파티 라이브러리가 안전한 타입을 쓰는 방법은 함수 호출 시 전달된 매개변수 값을 건드리지 않고 매번 새로운 값을 반환하기 때문에 안전한 것이다.

## 요약
- 타입 구문을 줄이기 위해 직접 구현보다는 내장된 함수형 기법과 lodash같은 서드파티 유틸리티 라이브러리를 사용하는 것이 좋다.